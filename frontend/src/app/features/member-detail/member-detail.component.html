<div class="container py-4" *ngIf="member">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="m-0">{{ member.name }}</h2>
    <button mat-stroked-button color="primary" (click)="openEdit()">Edit / Renew</button>
  </div>
  <mat-tab-group>
    <mat-tab label="Overview">
      <div class="row g-3 mt-2">
        <div class="col-md-6">
          <h5 class="mb-2">Membership</h5>
          <table mat-table [dataSource]="[
            { label: 'Plan', value: member.membershipPlan?.name },
            { label: 'Status', value: member.status },
            { label: 'Expiry', value: member.endDate }
          ]" class="w-100 mat-elevation-z1">

            <ng-container matColumnDef="label">
              <th mat-header-cell *matHeaderCellDef>Label</th>
              <td mat-cell *matCellDef="let r">{{ r.label }}</td>
            </ng-container>

            <ng-container matColumnDef="value">
              <th mat-header-cell *matHeaderCellDef>Value</th>
              <td mat-cell *matCellDef="let r">{{ r.value }}</td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="['label','value']"></tr>
            <tr mat-row *matRowDef="let row; columns: ['label','value'];"></tr>
          </table>
        </div>
      </div>
    </mat-tab>
    <mat-tab label="Payments">
      <div class="d-flex justify-content-end mt-2">
        <button mat-raised-button color="warn" (click)="addPayment()">Add Payment</button>
      </div>
      <div class="mt-3">
        <table mat-table [dataSource]="payments" class="w-100 mat-elevation-z1">
          <ng-container matColumnDef="paidOn">
            <th mat-header-cell *matHeaderCellDef>Date</th>
            <td mat-cell *matCellDef="let p">{{ p.paidOn }}</td>
          </ng-container>
          <ng-container matColumnDef="amount">
            <th mat-header-cell *matHeaderCellDef>Amount</th>
            <td mat-cell *matCellDef="let p">{{ p.amount }}</td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="['paidOn','amount']"></tr>
          <tr mat-row *matRowDef="let row; columns: ['paidOn','amount'];"></tr>
        </table>
      </div>
    </mat-tab>
    <mat-tab label="Check-ins">
      <div class="d-flex justify-content-end mt-2">
        <button mat-raised-button color="primary" (click)="checkIn()">Check-in</button>
        <button mat-raised-button color="accent" class="ms-2" (click)="checkOut()">Check-out</button>
      </div>
      <div class="mt-3">
        <table mat-table [dataSource]="checkins" class="w-100 mat-elevation-z1">
          <ng-container matColumnDef="checkinAt">
            <th mat-header-cell *matHeaderCellDef>In</th>
            <td mat-cell *matCellDef="let c">{{ c.checkinAt | date:'d MMMM y h:mm:ssa' | lowercase }}</td>
          </ng-container>
          <ng-container matColumnDef="checkoutAt">
            <th mat-header-cell *matHeaderCellDef>Out</th>
            <td mat-cell *matCellDef="let c">{{ c.checkoutAt ? ((c.checkoutAt | date:'d MMMM y h:mm:ssa') | lowercase) : '-' }}</td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="['checkinAt','checkoutAt']"></tr>
          <tr mat-row *matRowDef="let row; columns: ['checkinAt','checkoutAt'];"></tr>
        </table>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>
